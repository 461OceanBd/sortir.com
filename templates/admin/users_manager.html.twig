{% extends 'layout.html.twig' %}

   {% block title %}
       Admin manager
   {% endblock %}



{% block body %}


    <h1>Tableau de bord administrateur [{{ app.user.name }}]</h1>


    <a href="{{ path('app_register') }}" class="btn btn-primary"
       role="button">
        Ajouter un nouveau membre
    </a>

    <table class="table table-striped members">
    <thead>
    <tr>
        <th colspan="3" align="justify"><h2>Liste des membres</h2></th>
    </tr>
    </thead>
    <thead>
    <tr>
        <th colspan="1" align="justify">Nom</th>
        <th colspan="1" align="justify">Prénom</th>
        <th colspan="1" align="justify">Pseudo</th>
        <th colspan="1" align="justify">Status</th>
        <th colspan="1" align="justify">Nombre de connexions</th>
        <th colspan="1" align="justify">Date dernière connexion</th>
        <th colspan="1" align="justify">Dernière connexion</th>
        <th colspan="1" align="justify">Actions</th>
    </tr>
    </thead>

    <tbody>

    {% for member in members %}

        {% if member != app.user %}
            <tr>
                <td>{{ member.surname | capitalize }}</td>
                <td>{{ member.name | capitalize }}</td>
                <td>{{ member.pseudo | capitalize }}</td>

                {% if member.active %}
                    <td><span class="badge badge-success">actif</span></td>
                {% else %}
                    <td><span class="badge badge-secondary">inactif</span></td>
                {% endif %}
                <td>{{ member.nbConnection }}</td>

                {% if member.lastConnectionDateTime is not null %}

                    {% set intervalLastConnexion = member.lastConnectionDateTime.diff( date() ) %}
                    {% set days = intervalLastConnexion.days %}
                    {% set years = intervalLastConnexion.y %}
                    {% set hours = intervalLastConnexion.h %}
                    {% set minutes = intervalLastConnexion.i %}
                    {% set secondes = intervalLastConnexion.s %}

                    <td>
                        {{ member.lastConnectionDateTime | date('H:i:s d/m/Y') }}
                    </td>

                    <td>
                        {% if years != 0 %}
                            {{ years }} année(s)
                        {% else %}

                            {% if days != 0 %}
                                {{ days }} jour(s)
                            {% endif %}
                            {% if hours != 0 %}
                                {{ hours }} heure(s)
                            {% endif %}
                            {% if minutes != 0 %}
                                {{ minutes }} minute(s)
                            {% endif %}
                            {% if secondes != 0 %}
                                {{ secondes }} seconde(s)
                            {% endif %}

                        {% endif %}
                    </td>



                    </td>
                {% else %}
                    <td>inconnue</td>
                {% endif %}

                <td>
                    <a href="{{ path('display_profile_member', {'id': member.id}) }}" class="btn btn-secondary"
                       role="button">
                        Accéder au profil
                    </a>
                </td>

                {# Actions#}
                {% if member.active %}
                    <td>
                        <button type="button" class="btn btn-primary">Activer</button>
                    </td>
                {% else %}
                    <td>
                        <button type="button" class="btn btn-warning">Desactiver</button>
                    </td>
                {% endif %}
                <td>
                    <button type="button" class="btn btn-danger">Supprimer le compte</button>
                </td>


            </tr>
        {% endif %}

    {% endfor %}


    {% block JS %}






    {% endblock JS %}

{% endblock body %}